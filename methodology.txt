Log into your server as root: ssh root@168.231.114.46
Update Linux packages: apt update && apt upgrade -y
Create a new user: adduser david
Add this user to the sudo group: usermod -aG sudo david
Logout from your server: logout
Log in with your new user account: ssh david@168.231.114.46
Check if sudo works: sudo -v (If you don't get an error, it's good)
Create the SSH key folder: mkdir ~/.ssh && chmod 700 ~/.ssh
Confirm the folder exists: ls -a
Logout again: logout
Generate an SSH key on your local machine: ssh-keygen -t ed25519 -C "your_email@example.com"
Push this SSH key to your server:
Windows: scp $env:USERPROFILE/.ssh/id_ed25519.pub david@168.231.114.46:~/.ssh/authorized_keys
Mac: scp ~/.ssh/id_ed25519.pub david@168.231.114.46:~/.ssh/authorized_keys
Linux: ssh-copy-id david@168.231.114.46
Log back into your server: ssh david@168.231.114.46
Open SSH configuration: sudo nano /etc/ssh/sshd_config
Disable IPv6: AddressFamily inet
Disable password: PasswordAuthentication no
Disable root login: PermitRootLogin no
If there is an included .conf file, make it empty. E.g. sudo nano /etc/ssh/sshd_config.d/*.conf
Restart SSH: sudo systemctl restart ssh (On some distros it's sshd instead of ssh)
Logout, verify that root + password logins are disabled
Log back into your server
Install firewall: sudo apt install ufw
Whitelist ports: sudo ufw allow ssh + http + https
Enable firewall: sudo ufw enable
Check firewall status: sudo ufw status
Open firewall rules: sudo nano /etc/ufw/before.rules
Add this to the INPUT block: -A ufw-before-input -p icmp --icmp-type echo-request -j DROP
Reboot the server: sudo reboot. Log back in once the server is reachable again.
Download & install Node.js:
curl -fsSL https://deb.nodesource.com/setup_22.x -o nodesource_setup.sh
sudo -E bash nodesource_setup.sh
sudo apt-get install nodejs -y
Check Node + NPM version: node -v, npm -v
Install Git & check version: sudo apt install git, git -v
Install PostgreSQL: sudo apt install postgresql postgresql-contrib
Start PostgreSQL: sudo systemctl start postgresql.service
Check if PostgreSQL is running: sudo service postgresql status
Start the Postgres prompt: sudo -u postgres psql
Run these commands inside PostgreSQL to create a database + user:
CREATE DATABASE annhurst;
CREATE USER david WITH ENCRYPTED PASSWORD 'Annhurst123#';
ALTER ROLE david SET client_encoding TO 'utf8';
ALTER ROLE david SET default_transaction_isolation TO 'read committed';
ALTER ROLE david SET timezone TO 'UTC';
GRANT ALL PRIVILEGES ON DATABASE annhurst TO david;
\c annhurst postgres
GRANT ALL PRIVILEGES ON SCHEMA public TO david;
Exit PostgreSQL: \q
Create an apps folder: mkdir apps
Navigate to /apps: cd apps/ (Use cd .. to go back)
Git clone the sample repo (or use your own): git clone https://github.com/Djonahuti/Annhurst-ts
Open the project folder: cd Annhurst-ts/
Create a .env file: sudo nano .env and add the following:
DATABASE_URL=postgresql://david:Annhurst123%23@localhost:5432/annhurst?schema=public
NEXTAUTH_SECRET=1398c9c0b3681b1f326a2de5580bd3ba1ed1ebfc605bb6c7373b80eec3c4ac89
NEXTAUTH_URL=http://localhost:3000
Install NPM packages: npm install
Install Nginx: sudo apt install nginx
Create an Nginx configuration file: sudo nano /etc/nginx/sites-available/nextjs.conf and insert the following (Don't forget to insert your server IP):
server {
 listen 80;
 server_name 168.231.114.46;

 location / {
  proxy_pass http://localhost:3000;
  proxy_http_version 1.1;
  proxy_set_header Upgrade $http_upgrade;
  proxy_set_header Connection 'upgrade';
  proxy_set_header Host $host;
  proxy_cache_bypass $http_upgrade;
  
  # Disable buffering to allow streaming responses
  proxy_buffering off;
  proxy_set_header X-Accel-Buffering no;
 }
}
Link your new configuration file: sudo ln -s /etc/nginx/sites-available/nextjs.conf /etc/nginx/sites-enabled/
Remove the default configuration: sudo rm /etc/nginx/sites-enabled/default
Check if your Nginx config is valid: sudo nginx -t
Restart Nginx: sudo service nginx restart
Push the database schema (This depends on your ORM/DB library): npx prisma db push
Build and run the project: npm run build, npm start
Now you can open your website at http://168.231.114.46 but the process will stop when you close the terminal.
Install PM2: sudo npm install -g pm2
Run your Next.js app via PM2: pm2 start npm --name "nextjs" -- start
Useful PM2 commands:
Check status: pm2 status
Show logs: pm2 logs (Close with Ctrl + C)
Clear logs: pm2 flush
Restart Next.js app (to apply changes): pm2 restart nextjs
Show the PM2 startup script: pm2 startup. Copy and execute the printed command.
Now, even if you reboot your server, PM2 should restart your Next.js app automatically: sudo reboot
Buy a domain, for example at Namecheap
Go to your Hostinger dashboard -> DNS Manager -> Add Domain and follow the instructions
Update the server name in your Nginx config: sudo nano /etc/nginx/sites-available/nextjs.conf:
server_name annhurst-ts.com www.annhurst-ts.com;
Restart Nginx: sudo service nginx restart
Install Certbot: sudo snap install --classic certbot
Prepare Certbot command: sudo ln -s /snap/bin/certbot /usr/bin/certbot
Install SSL certificates: sudo certbot --nginx
Test automatic rewenal: sudo certbot renew --dry-run